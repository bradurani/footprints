!function(t){var n={};function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";function o(t){var n=new Error(t);return n.source="ulid",n}e.r(n);var r="0123456789ABCDEFGHJKMNPQRSTVWXYZ",i=r.length,a=Math.pow(2,48)-1,u=10,s=16;function c(t){var n=Math.floor(t()*i);return n===i&&(n=i-1),r.charAt(n)}function f(t,n){if(isNaN(t))throw new Error(t+" must be a number");if(t>a)throw o("cannot encode time greater than "+a);if(t<0)throw o("time must be positive");if(!1===Number.isInteger(t))throw o("time must be an integer");for(var e=void 0,u="";n>0;n--)e=t%i,u=r.charAt(e)+u,t=(t-e)/i;return u}function p(t,n){for(var e="";t>0;t--)e=c(n)+e;return e}function l(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments[1];n||(n="undefined"!=typeof window?window:null);var r=n&&(n.crypto||n.msCrypto);if(r)return function(){var t=new Uint8Array(1);return r.getRandomValues(t),t[0]/255};try{var i=e(1);return function(){return i.randomBytes(1).readUInt8()/255}}catch(t){}if(t){try{console.error("secure crypto unusable, falling back to insecure Math.random()!")}catch(t){}return function(){return Math.random()}}throw o("secure crypto unusable, insecure Math.random not allowed")}function d(t){return t||(t=l()),function(n){return isNaN(n)&&(n=Date.now()),f(n,u)+p(s,t)}}d();e.d(n,"init",function(){return b});var h=d(l(!0)),v="Footprints",y=5e3;function b(t){if(t.initialized)console.error("Footprints already initialized");else{t.initialized=!0,t.state={basePayload:{},inputQueue:t.q||[],outputQueue:[]},t.noop=function(){},t.identity=function(t){return t};var n,e,o,r,i,a,u,s,c,f,p,l,d,b,g,w,m,O,I,C,P,k,j,F,N=function(t){return[].slice.call(t)};!function(){if(void 0===t.options)throw v.toUpperCase()+": your snippet must set "+v+".options to the options object";!function(n){if(void 0===n.endpointUrl)throw v.toUpperCase()+": you must pass the option endpointUrl";n.intervalWait=n.intervalWait||y,n.debug=n.debug||!1,n.pageTime=(n.pageTime||new Date).toISOString(),n.successCallback=n.successCallback||t.noop,n.errorCallback=n.errorCallback||t.noop,n.uniqueIdFunc=n.uniqueIdFunc||h,n.readyCallback=n.readyCallback||t.noop,n.transformPayloadFunc=n.transformPayloadFunc||t.identity,n.pageId=n.pageId||n.uniqueIdFunc()}(t.options),t.state.basePayload.pageTime=t.options.pageTime,t.state.basePayload.pageId=t.options.pageId;var n=function(){"function"==typeof t.processQueues&&t.processQueues()};t.push=function(){t.state.inputQueue.push(N(arguments)),n()},window.setInterval(function(){n()},t.options.intervalWait)}(),n=t.state.inputQueue,e=t.state.outputQueue,o=t.state.basePayload,r=t.options.endpointUrl,i=t.options.successCallback,a=t.options.errorCallback,u=t.options.uniqueIdFunc,s=t.options.readyCallback,c=t.options.transformPayloadFunc,f=t.options.debug,p=t.options.fetchOptions,l=t.processQueues=function(){d(),m()},d=function(){var t,e;for(j("processing input queue",n);t=n.shift();)e=t.shift(),b(e,t)},b=function(t,n){j("processing action ",t,n);var e=P[t];"function"==typeof e?e.apply(null,n):F("Unknown function",t)},g=function(t,n){var e,o=(e=n,JSON.parse(JSON.stringify(e)));o.eventTime=(new Date).toISOString(),o.eventId=u(),o.eventType=t,o=c(o),w(o)},w=function(t){e.push(t)},m=function(){var t;for(j("processing output queue");t=e.shift();)O(t)},O=function(t){j("sending event",t);var n=Object.assign(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});fetch(r,n).then(function(t){if(t.status>=200&&t.status<300)return t;var n=new Error(t.statusText);throw n.response=t,n}).then(I.bind(null,t)).catch(function(n){C(t,n)})},I=function(t,n){i(n),j("Event Sent",t)},C=function(t,n){w(t),a(n),F("Event Failed",n,t)},P={pageView:function(t,n){var e=Object.assign({},o,n,k());t&&(e.name=t),g("pageView",e)},user:function(t,n){var e=Object.assign({},n);"object"==typeof t?e=Object.assign(e,t):t&&(e.userId=t),P.context(e)},track:function(t,n){var e=Object.assign(o,n);t&&(e.eventName=t),g("track",e)},context:function(n){t.state.basePayload=o=Object.assign(o,n)}},k=function(){var t={};try{t.url=window.location.href,t.path=window.location.path,t.referer=document.referer,t.title=document.title}catch(t){F("could not get page props",t)}return t},j=function(){if(f){var t=N(arguments);t.unshift(v+":"),console.log.apply(this,t)}},F=function(){if(f){var t=N(arguments);t.unshift(v+":"),console.error.apply(this,t)}},function(){for(var e in P)P.hasOwnProperty(e)&&(t[e]=function(t){return function(){var e,o=N(arguments);o.unshift(t),e=o,n.push(e),l()}}(e))}(),s(),l()}}window[v]&&b(window[v])},function(t,n){}]);
//# sourceMappingURL=footprints.min.js.map